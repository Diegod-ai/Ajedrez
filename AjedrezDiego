#lang racket

( require graphics/graphics )
(open-graphics) 
(define ventana1 (open-viewport "Ajedrez"  500 600))


(define (dibujar a b e)
  (if (> e 8)
      ((draw-rectangle ventana1) (make-posn 49 49) 401 401 "black")
      (if (> a 400)
          (dibujar 50 (+ b 50) (+ e 1))
          (begin
            (if(odd? e)
               (if(odd?(/ a 50))
                  (dibujar(+ a 50)b e)
                  (begin
                    ((draw-solid-rectangle ventana1)(make-posn a b)50 50 "slate blue")
                    (dibujar(+ a 50)b e))     
                  )
                (if(odd?(/ a 50))
                  (begin
                    ((draw-solid-rectangle ventana1)(make-posn a b)50 50 "slate blue")
                    (dibujar(+ a 50)b e))
                  (dibujar(+ a 50)b e))        
               )
            )
          )
      )
  )

(dibujar 50 50 1)

;fichas blancas
(define BishopW   "WhitePieces/whiteBishop.png")
(define KnightW "WhitePieces/whiteKnight.png")
(define rookW   "WhitePieces/whiteRook.png")
(define kingW     "WhitePieces/whiteKing.png")
(define queenW   "WhitePieces/whiteQueen.png")
(define pawnW    "WhitePieces/whitePawn.png" )


;fichas negras
(define BishopB   "BlackPieces/blackBishop.png")
(define KnightB "BlackPieces/blackKnight.png")
(define rookB   "BlackPieces/blackRook.png")
(define kingB     "BlackPieces/blackKing.png")
(define queenB   "BlackPieces/blackQueen.png")
(define pawnB "BlackPieces/blackPawn.png" )
 

;finalizar de llamar fichas negras

;PieceAsignament evalua el caracter que se encuentra en otra funcion y lo evalua con un caracter que
;se refiere a una pieza del ajedrez, y despues le afilia una imagen 
( define ( PieceAsignament char)
  ( if ( equal? char #\T)
      rookB
      ( if ( equal? char #\C)
          KnightB
          ( if ( equal? char #\A)
              BishopB
              ( if ( equal? char #\D)
                  queenB
                  (if ( equal? char #\R )
                      kingB
                      (if ( equal? char #\P )
                          pawnB
                          ( if ( equal? char #\t)
                               rookW
                               ( if ( equal? char #\c)
                                    KnightW
                                    ( if ( equal? char #\a)
                                         BishopW
                                         ( if ( equal? char #\d)
                                              queenW
                                              (if ( equal? char #\r)
                                                  kingW
                                                  (if ( equal? char #\p )
                                                      pawnW 
                                                      "";else
                                                  ) ;end if ( equal? char #\p)
                                              ) ;end if ( equal? char #\r)        
                                         ) ;end if ( equal? char #\d)             
                                    ) ;end if ( equal? char #\a)                  
                               ) ;end if ( equal? char #\c)                       
                          ) ;end if ( equal? char #\t)
                      ) ;end if ( equal? char #\P) 
                  ) ;end if ( equal? char #\R)
              ) ;end if ( equal? char #\D)
          ) ;end if ( equal? char #\A)
      ) ;end if ( equal? char #\C)
  ) ;end if ( equal? char #\T)
) ;endFunction PieceAsignament

; InicialTable nos muestra el tablero inicial
(define InicialTable (string-append
                   "TCADRACT"
                   "PPPPPPPP"
                   "xxxxxxxx"
                   "xxxxxxxx"
                   "xxxxxxxx"
                   "xxxxxxxx"
                   "pppppppp"
                   "tcadract"))


;;Creamos la funcion PiecePut que sirve para poner la ficha en su lugar correspondiente
;;comparando cada parte de la funcion "InicialTabl"

 (define (PiecePut str count)
  (if (< count (string-length str))
        (if (not (equal? (string-ref str count) #\x))
            (begin
              (((draw-pixmap-posn (PieceAsignament (string-ref str count))) ventana1) (make-posn (* (+ 1 (remainder count 8)) 50) (* (+ 1 (quotient count 8)) 50)))
              (PiecePut str (+ count 1))
            );endBegin and start else
               (PiecePut str (+ count 1))
        );end (if (not (equal? (string-ref str count) #\x)) and start else
        (void)        
  );end (if (< count (string-length str))
 ); EndFunction PiecePut

(PiecePut InicialTable 0)



